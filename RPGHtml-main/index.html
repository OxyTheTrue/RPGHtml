<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RPG Visual Mastery Pro - Bleeding & Sound Edition</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="stat-tooltip">
    <i id="tooltip-icon"></i>
    <div class="stat-name" id="tooltip-name"></div>
    <div class="stat-detail">Nível: <span id="tooltip-level"></span></div>
    <div class="stat-detail">Valor atual: <span class="stat-value" id="tooltip-value"></span></div>
</div>
<div id="start-menu">
    <div class="game-title">MASTERY RPG</div>
    <!-- Etapa 0: apenas botões do menu -->
    <div id="menu-step-buttons" class="menu-step">
        <button class="action-btn btn-atk btn-menu" data-action="start-new">
            <i class="fa-solid fa-play"></i> NOVO JOGO
        </button>
        <button class="action-btn btn-heal btn-menu" data-action="continue-current">
            <i class="fa-solid fa-forward"></i> CONTINUAR
        </button>
        <button class="action-btn btn-def btn-menu" data-action="load-manual">
            <i class="fa-solid fa-folder-open"></i> CARREGAR
        </button>
    </div>
    <!-- Etapa 1: nome (só ao clicar em Novo Jogo) -->
    <div id="menu-step-name" class="menu-step" style="display: none;">
        <input type="text" id="player-name-input" class="name-input" placeholder="Digite seu nome..." maxlength="12">
        <button class="action-btn btn-heal btn-menu" data-action="menu-name-next">
            <i class="fa-solid fa-arrow-right"></i> PRÓXIMO
        </button>
        <button class="action-btn btn-def btn-menu" data-action="menu-back">
            <i class="fa-solid fa-arrow-left"></i> VOLTAR
        </button>
    </div>
    <!-- Etapa 2: dificuldade (Fácil / Normal / Difícil) -->
    <div id="menu-step-difficulty" class="menu-step" style="display: none;">
        <p class="menu-subtitle">Escolha a dificuldade</p>
        <div class="menu-difficulty-btns">
            <button class="action-btn btn-heal btn-diff" data-difficulty="0.75">FÁCIL</button>
            <button class="action-btn btn-atk btn-diff" data-difficulty="1">NORMAL</button>
            <button class="action-btn btn-def btn-diff" data-difficulty="1.25">DIFÍCIL</button>
        </div>
        <button class="action-btn btn-def btn-menu" data-action="menu-back">
            <i class="fa-solid fa-arrow-left"></i> VOLTAR
        </button>
    </div>
    <!-- Etapa 3: Carregar saves manuais -->
    <div id="menu-step-load" class="menu-step" style="display: none;">
        <p class="menu-subtitle">SELECIONE UM SAVE</p>
        <div class="save-slots-container">
            <div class="save-slot" data-slot="0">
                <div class="save-slot-header">
                    <span class="save-slot-title">SLOT 1</span>
                    <button class="save-slot-delete" data-slot="0" title="Deletar save">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
                <div class="save-slot-content empty">
                    <i class="fa-solid fa-plus"></i>
                    <span>Vazio</span>
                </div>
            </div>
            
            <div class="save-slot" data-slot="1">
                <div class="save-slot-header">
                    <span class="save-slot-title">SLOT 2</span>
                    <button class="save-slot-delete" data-slot="1" title="Deletar save">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
                <div class="save-slot-content empty">
                    <i class="fa-solid fa-plus"></i>
                    <span>Vazio</span>
                </div>
            </div>
            
            <div class="save-slot" data-slot="2">
                <div class="save-slot-header">
                    <span class="save-slot-title">SLOT 3</span>
                    <button class="save-slot-delete" data-slot="2" title="Deletar save">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
                <div class="save-slot-content empty">
                    <i class="fa-solid fa-plus"></i>
                    <span>Vazio</span>
                </div>
            </div>
        </div>
        <button class="action-btn btn-def btn-menu" data-action="menu-back">
            <i class="fa-solid fa-arrow-left"></i> VOLTAR
        </button>
    </div>
</div>
<div class="overlay" id="overlay"></div>
<div id="skill-detail-modal" style="display: none;">
    <div id="skill-detail-content"></div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
        <button id="learn-confirm-btn" class="action-btn btn-heal">APRENDER</button>
        <button class="action-btn btn-atk">VOLTAR</button>
    </div>
</div>
<div id="skill-modal" style="display: none;">
    <h3 style="color: var(--mana); margin-top: 0; letter-spacing: 2px;">ÁRVORE DE HABILIDADES</h3>
    <div style="background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 20px; display: inline-block; margin-bottom: 10px;">
        <small>PONTOS DISPONÍVEIS: <span id="p-skill-points" style="color:var(--accent); font-weight: bold;">0</span></small>
    </div>
    <div class="skill-tree-grid" id="skill-tree-content"></div>
    <button class="action-btn btn-def" style="width: 100%; margin-top: 20px;">SAIR</button>
</div>
<div id="shop-modal" style="display: none;">
    <h3 class="shop-title">LOJA DO ALQUIMISTA</h3>
    <div class="shop-grid shop-grid-2x4">
        <button class="action-btn shop-item-btn shop-item" data-item-type="potion">
            <span class="shop-item-icon"><i class="fa-solid fa-flask"></i></span>
            <span class="shop-item-name">Poção HP</span>
            <span class="shop-item-desc">+18 HP</span>
            <span class="shop-item-price"><span class="item-price">28</span> G</span>
        </button>
        <button class="action-btn shop-item-btn shop-item" data-item-type="mana_potion">
            <span class="shop-item-icon"><i class="fa-solid fa-flask-vial"></i></span>
            <span class="shop-item-name">Poção MP</span>
            <span class="shop-item-desc">+22 MANA</span>
            <span class="shop-item-price"><span class="item-price">32</span> G</span>
        </button>
        <button class="action-btn shop-item-btn shop-item" data-item-type="boots">
            <span class="shop-item-icon"><i class="fa-solid fa-boot"></i></span>
            <span class="shop-item-name">Botas</span>
            <span class="shop-item-desc">+SPD (Ativo)</span>
            <span class="shop-item-price"><span class="item-price">58</span> G</span>
        </button>
        <button class="action-btn shop-item-btn shop-item" data-item-type="shield">
            <span class="shop-item-icon"><i class="fa-solid fa-shield-halved"></i></span>
            <span class="shop-item-name">Escudo</span>
            <span class="shop-item-desc">-Dano (Ativo)</span>
            <span class="shop-item-price"><span class="item-price">78</span> G</span>
        </button>
        <button class="action-btn shop-item-btn shop-item shop-item-span-2" data-item-type="coin">
            <span class="shop-item-icon"><i class="fa-solid fa-coins"></i></span>
            <span class="shop-item-name">Moeda da Sorte</span>
            <span class="shop-item-desc">+Sorte (Ativo)</span>
            <span class="shop-item-price"><span class="item-price">125</span> G</span>
        </button>
    </div>
    <button class="action-btn btn-def" id="close-shop-btn" data-action="close-shop">FECHAR</button>
</div>
<div id="settings-modal" style="display: none;">
    <h3 class="settings-title">CONFIGURAÇÕES</h3>
    <div class="settings-body">
        <label class="settings-row">
            <input type="checkbox" id="settings-mute" data-setting="mute">
            <span><i class="fa-solid fa-volume-high"></i> Mudo (desmarque para som)</span>
        </label>
        <button class="action-btn btn-heal" data-action="manual-save">
            <i class="fa-solid fa-floppy-disk"></i> SALVAR PROGRESSO
        </button>
        <button class="action-btn btn-def" data-action="save-to-slot" data-slot="0">
            <i class="fa-solid fa-save"></i> SALVAR NO SLOT 1
        </button>
        <button class="action-btn btn-def" data-action="save-to-slot" data-slot="1">
            <i class="fa-solid fa-save"></i> SALVAR NO SLOT 2
        </button>
        <button class="action-btn btn-def" data-action="save-to-slot" data-slot="2">
            <i class="fa-solid fa-save"></i> SALVAR NO SLOT 3
        </button>
    </div>
    <button class="action-btn btn-def" data-action="close-settings">FECHAR</button>
</div>
<div id="death-modal" style="display: none;">
    <h2 style="color: var(--primary); margin-top: 0;">Você conheceu a DERROTA!</h2>
    <p style="font-size: 0.9rem; opacity: 0.8; line-height: 1.4;">
        Seu conhecimento e atributos foram preservados,<br>mas seu <b>ouro, xp e itens</b> se perderam.
    </p>
    <button class="action-btn btn-heal" style="width: 100%; margin-bottom: 10px;" data-action="restart-after-death">
        <i class="fa-solid fa-rotate-left"></i> TENTAR NOVAMENTE
    </button>
    <button class="action-btn btn-atk" style="width: 100%; background: #441111;" data-action="exit-to-menu">
        <i class="fa-solid fa-door-open"></i> DESISTIR
    </button>
</div>

<!-- Tela de Loot -->
<div id="loot-modal" style="display: none;">
    <h3 style="color: var(--accent); margin-top: 0; text-align: center;">VITÓRIA!</h3>
    <div id="loot-content" style="text-align: center; margin: 20px 0;">
        <!-- Conteúdo dinâmico -->
    </div>
    <button class="action-btn btn-heal" style="width: 100%;" data-action="continue-after-loot">
        <i class="fa-solid fa-forward"></i> CONTINUAR
    </button>
</div>
<div class="main-wrapper" id="game-ui">
    <!-- Header Superior -->
    <header class="game-header">
        <button class="action-btn btn-def" id="btn-settings" data-action="open-settings">
            <i class="fa-solid fa-gear"></i>
        </button>
        
        <div class="player-info-header">
            <div class="player-name-level">
                <h2 id="p-display-name">GUERREIRO</h2>
                <span class="level-badge">NÍVEL <span id="p-lv">1</span></span>
            </div>
            <div class="gold-display">
                <i class="fa-solid fa-coins"></i>
                <span id="p-gold">0</span>
            </div>
        </div>

        <div class="header-actions">
            <button class="action-btn btn-open-tree" data-action="open-skill-tree">
                <i class="fa-solid fa-diagram-project"></i> SKILLS
            </button>
            
            <button class="action-btn btn-heal btn-shop" data-action="open-shop">
                <i class="fa-solid fa-store"></i> LOJA
            </button>

            <button class="action-btn btn-def" id="toggle-stats-btn">
                <i class="fa-solid fa-chart-line"></i> STATUS
            </button>

            <!-- Inventory Mini -->
            <div class="inventory-mini">
                <div class="inventory-slots" id="p-slots">
                    <div class="slot"></div>
                    <div class="slot"></div>
                    <div class="slot"></div>
                    <div class="slot"></div>
                    <div class="slot"></div>
                </div>
            </div>
        </div>

        <button class="action-btn btn-atk btn-exit" data-action="save-exit">
            <i class="fa-solid fa-door-open"></i> SAIR
        </button>
    </header>

    <!-- Área de Combate Principal -->
    <main class="combat-arena">
        <!-- Seção do Player (agora à esquerda) -->
        <section class="player-section">
            <div class="player-visual">
                <div class="player-avatar">
                    <img id="player-img" src="" alt="Player" class="player-sprite">
                    <div class="damage-indicators" id="player-damage-indicators"></div>
                </div>
                
                <div class="player-level-progress">
                    <div class="xp-bar-container">
                        <div id="p-xp-bar" class="xp-bar"></div>
                    </div>
                    <div class="xp-text">
                        <small>EXP: <span id="p-xp-current">0</span>/<span id="p-xp-needed">100</span></small>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seção Central de Combate -->
        <section class="battle-section">
            <!-- Player Status Compacto -->
            <div class="player-status-compact">
                <div class="status-bars">
                    <div class="status-item hp">
                        <div class="status-icon"><i class="fa-solid fa-heart"></i></div>
                        <div class="bar-container">
                            <div id="p-hp-bar" class="health-fill"></div>
                        </div>
                        <span class="status-text"><span id="p-hp">0</span>/<span id="p-max-hp">0</span></span>
                        <div id="p-status-icons" class="status-icons"></div>
                    </div>
                    
                    <div class="status-item mana">
                        <div class="status-icon"><i class="fa-solid fa-wand-sparkles"></i></div>
                        <div class="bar-container">
                            <div id="p-mana-bar" class="health-fill"></div>
                        </div>
                        <span class="status-text"><span id="p-mana">0</span></span>
                    </div>
                    
                    <div class="status-item fury">
                        <div class="status-icon"><i class="fa-solid fa-fire-glow"></i></div>
                        <div class="bar-container">
                            <div id="p-furia-bar" class="health-fill"></div>
                        </div>
                        <span class="status-text">FÚRIA</span>
                    </div>
                </div>
            </div>

            <!-- Área de Ações de Combate -->
            <div class="combat-actions" id="action-buttons">
                <!-- Botões serão gerados dinamicamente -->
            </div>

            <!-- Indicadores de Combate -->
            <div class="combat-feedback" id="combat-feedback">
                <!-- Damage flutuante e efeitos visuais -->
            </div>
        </section>

        <!-- Seção do Inimigo (agora à direita) -->
        <section class="enemy-section">
            <div class="enemy-visual">
                <div class="enemy-sprite-container">
                    <img id="enemy-img" src="" alt="" class="enemy-sprite">
                    <div class="damage-indicators" id="enemy-damage-indicators"></div>
                </div>
                
                <div class="enemy-health-bar">
                    <div class="health-bar-container">
                        <div id="enemy-bar" class="health-fill"></div>
                    </div>
                    <div class="health-text">
                        <span id="enemy-hp">0</span> / <span id="enemy-max-hp">0</span>
                    </div>
                </div>
                
                <div class="enemy-info">
                    <h3 id="enemy-name">BUSCANDO...</h3>
                    <div id="enemy-badges" class="enemy-badges"></div>
                </div>
            </div>
        </section>
    </main>
</div>

<!-- Loading Screen -->
    <div id="loading-screen" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fa-solid fa-spinner fa-spin"></i>
            </div>
            <div class="loading-text">CARREGANDO...</div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

<!-- Save Modal -->
    <div id="save-modal" style="display: none;">
        <div class="save-modal-content">
            <div class="save-icon">
                <i class="fa-solid fa-floppy-disk"></i>
            </div>
            <div class="save-message">
                <h3>JOGO SALVO!</h3>
                <p>Seu progresso foi salvo com sucesso</p>
            </div>
            <div class="save-checkmark">
                <i class="fa-solid fa-check"></i>
            </div>
        </div>
    </div>

<!-- Painel de Status Lateral (Oculto por padrão) -->
<aside class="stats-panel" id="stats-panel">
    <div class="stats-header">
        <h3>FICHA DE PERSONAGEM</h3>
        <button class="close-btn" id="close-stats-btn">
            <i class="fa-solid fa-times"></i>
        </button>
    </div>
    
    <div class="stats-content">
        <div class="attributes-section">
            <h4>ATRIBUTOS</h4>
            
            <div class="attribute-card">
                <div class="attr-info" data-stat="str">
                    <i class="fa-solid fa-hand-fist"></i>
                    <span class="attr-name">FORÇA</span>
                    <span class="attr-value" id="stat-str">1</span>
                </div>
                <button class="lvl-up-btn" data-stat="str">+</button>
            </div>
            
            <div class="attribute-card">
                <div class="attr-info" data-stat="spd">
                    <i class="fa-solid fa-bolt"></i>
                    <span class="attr-name">VELOCIDADE</span>
                    <span class="attr-value" id="stat-spd">1</span>
                </div>
                <button class="lvl-up-btn" data-stat="spd">+</button>
            </div>
            
            <div class="attribute-card">
                <div class="attr-info" data-stat="int">
                    <i class="fa-solid fa-brain"></i>
                    <span class="attr-name">INTELIGÊNCIA</span>
                    <span class="attr-value" id="stat-int">1</span>
                </div>
                <button class="lvl-up-btn" data-stat="int">+</button>
            </div>
            
            <div class="attribute-card">
                <div class="attr-info" data-stat="luk">
                    <i class="fa-solid fa-clover"></i>
                    <span class="attr-name">SORTE</span>
                    <span class="attr-value" id="stat-luk">1</span>
                </div>
                <button class="lvl-up-btn" data-stat="luk">+</button>
            </div>
            
            <div class="attribute-card">
                <div class="attr-info" data-stat="vit">
                    <i class="fa-solid fa-heart-pulse"></i>
                    <span class="attr-name">VITALIDADE</span>
                    <span class="attr-value" id="stat-vit">1</span>
                </div>
                <button class="lvl-up-btn" data-stat="vit">+</button>
            </div>
        </div>

        <div class="skills-section">
            <h4>HABILIDADES APRENDIDAS</h4>
            <div id="learned-skills-list" class="learned-skills">
                <!-- Skills aprendidas serão listadas aqui -->
            </div>
        </div>

        <div class="progress-section">
            <h4>PROGRESSO</h4>
            <div class="progress-info">
                <div class="progress-item">
                    <span>Pontos de Skill:</span>
                    <span id="p-skill-points-display" class="highlight">0</span>
                </div>
                <div class="progress-item">
                    <span>Próximo Nível:</span>
                    <span id="p-xp-to-next" class="highlight">100 XP</span>
                </div>
            </div>
        </div>
    </div>
</aside>
<div id="admin-panel" class="admin-panel" aria-hidden="true"></div>
<link rel="stylesheet" href="admin-panel.css">
<script type="module" src="js/main.js"></script>
</body>
</html>
